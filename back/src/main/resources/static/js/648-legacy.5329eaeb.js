"use strict";(self["webpackChunk_405quan"]=self["webpackChunk_405quan"]||[]).push([[648],{92648:function(e,n,t){t.r(n),t.d(n,{default:function(){return U}});t(62010);var a=t(56768),l=t(24232),r={class:"common-layout"},o={class:"main"},s={class:"profile-card-wrapper"},u={class:"profile-header"},c=["src"],i={class:"profile-info"},d={class:"profile-name"},p={class:"profile-signature"},f={class:"profile-stats"},k={class:"profile-stat"},v={class:"profile-stat"},g={class:"profile-stat"},m={class:"post-form-wrapper"},h=["src"],b={class:"el-upload-list__item-actions"},w=["onClick"],_=["onClick"],L=["onClick"],C=["src"],x={class:"card-wrapper"};function F(e,n,t,F,y,P){var A=(0,a.g2)("Header"),V=(0,a.g2)("el-header"),R=(0,a.g2)("el-card"),I=(0,a.g2)("el-input"),K=(0,a.g2)("Plus"),E=(0,a.g2)("el-icon"),T=(0,a.g2)("zoom-in"),D=(0,a.g2)("Download"),U=(0,a.g2)("Delete"),X=(0,a.g2)("el-upload"),j=(0,a.g2)("el-dialog"),H=(0,a.g2)("el-button"),S=(0,a.g2)("PostCard"),q=(0,a.g2)("el-main"),G=(0,a.g2)("el-container");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(G,null,{default:(0,a.k6)((function(){return[(0,a.bF)(V,{class:"header"},{default:(0,a.k6)((function(){return[(0,a.bF)(A)]})),_:1}),(0,a.bF)(q,{style:{padding:"0px"}},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",o,[(0,a.Lk)("div",s,[(0,a.bF)(R,{class:"profile-card",style:{width:"250px"}},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",u,[(0,a.Lk)("img",{src:F.user.avatar,alt:"Avatar",class:"profile-avatar"},null,8,c),(0,a.Lk)("div",i,[(0,a.Lk)("span",d,(0,l.v_)(F.user.name),1),(0,a.Lk)("span",p,(0,l.v_)(F.user.signature),1)])]),(0,a.Lk)("div",f,[(0,a.Lk)("div",k,[n[2]||(n[2]=(0,a.Lk)("span",{class:"stat-label"},"总说说数:",-1)),(0,a.Lk)("span",null,(0,l.v_)(F.user.totalPosts),1)]),(0,a.Lk)("div",v,[n[3]||(n[3]=(0,a.Lk)("span",{class:"stat-label"},"总访客量:",-1)),(0,a.Lk)("span",null,(0,l.v_)(F.user.totalVisitors),1)]),(0,a.Lk)("div",g,[n[4]||(n[4]=(0,a.Lk)("span",{class:"stat-label"},"总点赞量:",-1)),(0,a.Lk)("span",null,(0,l.v_)(F.user.totalLikes),1)])])]})),_:1})]),(0,a.Lk)("div",m,[(0,a.bF)(R,{class:"post-form-card",style:{width:"850px","margin-bottom":"10px"}},{default:(0,a.k6)((function(){return[(0,a.bF)(I,{type:"textarea",modelValue:F.newPostContent,"onUpdate:modelValue":n[0]||(n[0]=function(e){return F.newPostContent=e}),placeholder:"有什么新鲜事想分享吗？",rows:"3"},null,8,["modelValue"]),(0,a.bF)(X,{action:"","list-type":"picture-card","auto-upload":!1,"on-change":F.handleSuccess},{file:(0,a.k6)((function(e){var n=e.file;return[(0,a.Lk)("div",null,[(0,a.Lk)("img",{class:"el-upload-list__item-thumbnail",src:n.url,alt:""},null,8,h),(0,a.Lk)("span",b,[(0,a.Lk)("span",{class:"el-upload-list__item-preview",onClick:function(e){return F.handlePictureCardPreview(n)}},[(0,a.bF)(E,null,{default:(0,a.k6)((function(){return[(0,a.bF)(T)]})),_:1})],8,w),F.disabled?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",{key:0,class:"el-upload-list__item-delete",onClick:function(e){return F.handleDownload(n)}},[(0,a.bF)(E,null,{default:(0,a.k6)((function(){return[(0,a.bF)(D)]})),_:1})],8,_)),F.disabled?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",{key:1,class:"el-upload-list__item-delete",onClick:function(e){return F.handleRemove(n)}},[(0,a.bF)(E,null,{default:(0,a.k6)((function(){return[(0,a.bF)(U)]})),_:1})],8,L))])])]})),default:(0,a.k6)((function(){return[(0,a.bF)(E,null,{default:(0,a.k6)((function(){return[(0,a.bF)(K)]})),_:1})]})),_:1},8,["on-change"]),(0,a.bF)(j,{modelValue:F.dialogVisible,"onUpdate:modelValue":n[1]||(n[1]=function(e){return F.dialogVisible=e})},{default:(0,a.k6)((function(){return[(0,a.Lk)("img",{"w-full":"",src:F.dialogImageUrl,alt:"Preview Image"},null,8,C)]})),_:1},8,["modelValue"]),(0,a.bF)(H,{type:"primary",onClick:F.publishPost,style:{"margin-top":"10px"}},{default:(0,a.k6)((function(){return n[5]||(n[5]=[(0,a.eW)(" 发表说说 ")])})),_:1},8,["onClick"])]})),_:1})]),(0,a.Lk)("div",x,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(F.posts,(function(e){return(0,a.uX)(),(0,a.Wv)(R,{key:e.id,class:"post-card",style:{width:"850px","margin-bottom":"10px"}},{default:(0,a.k6)((function(){return[(0,a.bF)(S,{post:e,onComment:F.handleComment,onLike:F.handleLike},null,8,["post","onComment","onLike"])]})),_:2},1024)})),128))])])]})),_:1})]})),_:1})])}var y=t(14048),P=t(30388),A=(t(16280),t(28706),t(2008),t(50113),t(26099),t(98992),t(54520),t(72577),t(3949),t(8872),t(23500),t(98352)),V=t(60783),R=t(36966),I=t(90144),K=t(51219),E={components:{Header:A.A,PostCard:V.A},setup:function(){var e=(0,I.KR)(""),n=(0,I.KR)(!1),t=(0,I.KR)(!1),l=(0,I.KR)([]),r=(0,I.KR)(""),o=(0,I.KR)(null),s=localStorage.getItem("uid"),u=(0,I.KR)(""),c=((0,I.KR)(null),function(e){console.log(e)}),i=function(t){e.value=t.url,n.value=!0,console.log(e.value,t.url)},d=function(n){console.log(n),console.log(n.raw),e.value=n.raw,console.log(e.value)},p=function(n){e.value=n.raw,console.log(n.raw),console.log(e.value)};s?console.log("用户ID:",s):console.log("没有找到用户ID");var f=function(){var e=(0,P.A)((0,y.A)().mark((function e(){var n,t,a;return(0,y.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:4050/get_all_posts",{method:"GET",headers:{"Content-Type":"application/json"}});case 3:if(n=e.sent,n.ok){e.next=6;break}throw new Error("HTTP error! status: ".concat(n.status));case 6:return e.next=8,n.json();case 8:t=e.sent,200===t.code?(console.log(t),a=t.data.filter((function(e){return e.user.name===u.value})),l.value=a,m.value.totalPosts=l.value.length,m.value.totalLikes=a.reduce((function(e,n){return e+n.likes}),0)):K.nk.error(t.message||"获取个人说说信息失败"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),console.error("请求失败：",e.t0),K.nk.error("获取个人说说信息失败!");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,P.A)((0,y.A)().mark((function e(){var n,t;return(0,y.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s){e.next=4;break}return K.nk.error("用户丢失"),console.log("缺少uid"),e.abrupt("return");case 4:return e.prev=4,e.next=7,fetch("http://localhost:4050/get_user_info?uid=".concat(s),{method:"GET",headers:{"Content-Type":"application/json"}});case 7:if(n=e.sent,n.ok){e.next=10;break}throw new Error("HTTP error! status: ".concat(n.status));case 10:return e.next=12,n.json();case 12:t=e.sent,200===t.code?(console.log(t.message),u.value=t.data.uname):K.nk.error(t.message||"获取用户信息失败"),e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](4),console.error("请求失败：",e.t0),K.nk.error("获取用户信息失败!");case 20:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(){return e.apply(this,arguments)}}();(0,a.sV)((function(){k(),f()}));var v=function(e,n){console.log("评论说说 ".concat(e,": ").concat(n.content))},g=function(e){var n=l.value.find((function(n){return n.id===e}));n&&(n.likes+=1)},m=(0,I.KR)({avatar:"",name:"",signature:"",totalPosts:"",totalVisitors:"",totalLikes:""}),h=function(){var n=(0,P.A)((0,y.A)().mark((function n(){var t,a;return(0,y.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.value){n.next=3;break}return K.nk.error("内容不能为空！"),n.abrupt("return");case 3:return t=new FormData,t.append("content",r.value),t.append("uid",localStorage.getItem("uid")),t.append("image",e.value),console.log(e.value),t.forEach((function(e,n){console.log(n,e)})),n.prev=9,n.next=12,R.A.post("http://localhost:4050/add_post",t,{headers:{"Content-Type":"multipart/form-data"}});case 12:a=n.sent,200===a.data.code?(K.nk.success("发表成功！"),r.value="",o.value=null):K.nk.error("发布失败！"),n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](9),K.nk.error("发布失败！");case 19:case"end":return n.stop()}}),n,null,[[9,16]])})));return function(){return n.apply(this,arguments)}}();return{posts:l,handleComment:v,handleLike:g,user:m,uid:s,getUserData:k,uname:u,newPostContent:r,uploadedImage:o,publishPost:h,dialogImageUrl:e,dialogVisible:n,disabled:t,handleRemove:c,handlePictureCardPreview:i,handleDownload:d,handleSuccess:p}}},T=t(71241);const D=(0,T.A)(E,[["render",F],["__scopeId","data-v-5b319889"]]);var U=D}}]);
//# sourceMappingURL=648-legacy.5329eaeb.js.map