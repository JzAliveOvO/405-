"use strict";(self["webpackChunk_405quan"]=self["webpackChunk_405quan"]||[]).push([[91],{3091:function(e,l,a){a.r(l),a.d(l,{default:function(){return V}});var o=a(6768),t=a(4232);const s={class:"avatar-container"},d=["src"],r={class:"demo-basic--circle"},u={class:"block"},n=["src"],i={class:"profile-details",style:{"font-size":"18px","text-align":"left","padding-left":"230px"}},c={slot:"footer",class:"dialog-footer"},b={slot:"footer",class:"dialog-footer"},f={slot:"footer",class:"dialog-footer"};function k(e,l,a,k,p,g){const m=(0,o.g2)("Header"),w=(0,o.g2)("Setting"),F=(0,o.g2)("el-icon"),_=(0,o.g2)("el-menu-item"),h=(0,o.g2)("Lock"),v=(0,o.g2)("Avatar"),V=(0,o.g2)("el-menu"),D=(0,o.g2)("el-text"),P=(0,o.g2)("el-rate"),y=(0,o.g2)("el-row"),L=(0,o.g2)("el-col"),C=(0,o.g2)("el-card"),x=(0,o.g2)("el-aside"),W=(0,o.g2)("UserForm"),U=(0,o.g2)("el-main"),E=(0,o.g2)("el-container"),T=(0,o.g2)("el-input"),S=(0,o.g2)("el-form-item"),j=(0,o.g2)("el-option"),I=(0,o.g2)("el-select"),K=(0,o.g2)("el-date-picker"),R=(0,o.g2)("el-form"),H=(0,o.g2)("el-button"),A=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(m),(0,o.bF)(E,{style:{height:"100vh"}},{default:(0,o.k6)((()=>[(0,o.bF)(x,{class:"aside",width:"350px"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{class:"custom-card",shadow:"always"},{header:(0,o.k6)((()=>l[12]||(l[12]=[(0,o.Lk)("div",{class:"avatar-container"},[(0,o.Lk)("span",null,"个人设置")],-1)]))),footer:(0,o.k6)((()=>[(0,o.bF)(y,{justify:"center",align:"middle"},{default:(0,o.k6)((()=>[(0,o.bF)(L,{span:24},{default:(0,o.k6)((()=>[(0,o.bF)(D,null,{default:(0,o.k6)((()=>l[16]||(l[16]=[(0,o.eW)("请为我们打分")]))),_:1}),(0,o.bF)(y,{justify:"center",align:"middle"},{default:(0,o.k6)((()=>[(0,o.bF)(D,null,{default:(0,o.k6)((()=>l[17]||(l[17]=[(0,o.eW)("Rate")]))),_:1}),(0,o.bF)(P,{modelValue:k.value1,"onUpdate:modelValue":l[0]||(l[0]=e=>k.value1=e)},null,8,["modelValue"])])),_:1}),(0,o.bF)(D,null,{default:(0,o.k6)((()=>l[18]||(l[18]=[(0,o.eW)("感谢您的支持")]))),_:1})])),_:1})])),_:1})])),default:(0,o.k6)((()=>[(0,o.Lk)("div",s,[(0,o.Lk)("img",{src:k.user.avatar,class:"avatar",alt:"头像"},null,8,d)]),(0,o.bF)(V,{"default-active":k.activeMenu,class:"custom-menu"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{index:"1",onClick:k.openEditDialog},{default:(0,o.k6)((()=>[(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(w)])),_:1}),l[13]||(l[13]=(0,o.eW)(" 编辑资料 "))])),_:1},8,["onClick"]),(0,o.bF)(_,{index:"2",onClick:k.openPasswordDialog},{default:(0,o.k6)((()=>[(0,o.bF)(F,null,{default:(0,o.k6)((()=>[(0,o.bF)(h)])),_:1}),l[14]||(l[14]=(0,o.eW)(" 密码管理 "))])),_:1},8,["onClick"]),(0,o.bF)(_,{index:"3",onClick:k.openLogoutDialog},{default:(0,o.k6)((()=>[(0,o.bF)(F,{class:"large-icon"},{default:(0,o.k6)((()=>[(0,o.bF)(v)])),_:1}),l[15]||(l[15]=(0,o.eW)("退出登录 "))])),_:1},8,["onClick"])])),_:1},8,["default-active"])])),_:1})])),_:1}),(0,o.bF)(W,{ref:"userFormRef"},null,512),(0,o.bF)(U,{class:"main"},{default:(0,o.k6)((()=>[(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,{span:16},{default:(0,o.k6)((()=>[(0,o.bF)(C,{class:"profile-card",shadow:"hover"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",r,[(0,o.Lk)("div",u,[(0,o.Lk)("img",{src:k.user.avatar,class:"avatar2",alt:"头像"},null,8,n)])]),(0,o.Lk)("div",i,[(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[(0,o.eW)("昵称："+(0,t.v_)(k.user.uname),1)])),_:1})])),_:1}),(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[(0,o.eW)("个性签名："+(0,t.v_)(k.user.selfintroduction),1)])),_:1})])),_:1}),(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[(0,o.eW)("性别："+(0,t.v_)(k.user.sex),1)])),_:1})])),_:1}),(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[(0,o.eW)("生日："+(0,t.v_)(k.user.birth),1)])),_:1})])),_:1}),(0,o.bF)(y,null,{default:(0,o.k6)((()=>[(0,o.bF)(L,null,{default:(0,o.k6)((()=>[(0,o.eW)("绑定手机："+(0,t.v_)(k.user.tel),1)])),_:1})])),_:1})])])),_:1})])),_:1}),(0,o.bF)(L,{span:1}),(0,o.bF)(L,{span:7},{default:(0,o.k6)((()=>[(0,o.bF)(C,null,{default:(0,o.k6)((()=>l[19]||(l[19]=[(0,o.Lk)("p",null,"你可能感兴趣的人",-1)]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(A,{modelValue:k.isEditDialogVisible,"onUpdate:modelValue":l[6]||(l[6]=e=>k.isEditDialogVisible=e),title:"编辑资料",width:"500px","before-close":k.closeEditDialog},{default:(0,o.k6)((()=>[(0,o.bF)(R,null,{default:(0,o.k6)((()=>[(0,o.bF)(S,{label:"昵称","label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(T,{modelValue:k.user.uname,"onUpdate:modelValue":l[1]||(l[1]=e=>k.user.uname=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),(0,o.bF)(S,{label:"个性签名","label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(T,{modelValue:k.user.selfintroduction,"onUpdate:modelValue":l[2]||(l[2]=e=>k.user.selfintroduction=e),placeholder:"请输入个性签名"},null,8,["modelValue"])])),_:1}),(0,o.bF)(S,{label:"性别","label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(I,{modelValue:k.user.sex,"onUpdate:modelValue":l[3]||(l[3]=e=>k.user.sex=e),placeholder:"请选择性别"},{default:(0,o.k6)((()=>[(0,o.bF)(j,{label:"男",value:"男"}),(0,o.bF)(j,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(S,{label:"生日","label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(K,{modelValue:k.user.birth,"onUpdate:modelValue":l[4]||(l[4]=e=>k.user.birth=e),type:"date",placeholder:"请选择生日"},null,8,["modelValue"])])),_:1}),(0,o.bF)(S,{label:"绑定手机","label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(T,{modelValue:k.user.tel,"onUpdate:modelValue":l[5]||(l[5]=e=>k.user.tel=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.Lk)("span",c,[(0,o.bF)(H,{onClick:k.closeEditDialog},{default:(0,o.k6)((()=>l[20]||(l[20]=[(0,o.eW)("取消")]))),_:1},8,["onClick"]),(0,o.bF)(H,{type:"primary",onClick:k.saveUserData},{default:(0,o.k6)((()=>l[21]||(l[21]=[(0,o.eW)("保存修改")]))),_:1},8,["onClick"])])])),_:1},8,["modelValue","before-close"]),(0,o.bF)(A,{modelValue:k.isPasswordDialogVisible,"onUpdate:modelValue":l[10]||(l[10]=e=>k.isPasswordDialogVisible=e),title:"修改密码",width:"400px","before-close":k.closePasswordDialog},{default:(0,o.k6)((()=>[(0,o.bF)(R,{model:k.passwordData,"label-width":"100px"},{default:(0,o.k6)((()=>[(0,o.bF)(S,{label:"原密码"},{default:(0,o.k6)((()=>[(0,o.bF)(T,{modelValue:k.passwordData.oldPassword,"onUpdate:modelValue":l[7]||(l[7]=e=>k.passwordData.oldPassword=e),type:"password",placeholder:"请输入原密码"},null,8,["modelValue"])])),_:1}),(0,o.bF)(S,{label:"新密码"},{default:(0,o.k6)((()=>[(0,o.bF)(T,{modelValue:k.passwordData.newPassword,"onUpdate:modelValue":l[8]||(l[8]=e=>k.passwordData.newPassword=e),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])])),_:1}),(0,o.bF)(S,{label:"确认新密码"},{default:(0,o.k6)((()=>[(0,o.bF)(T,{modelValue:k.passwordData.confirmPassword,"onUpdate:modelValue":l[9]||(l[9]=e=>k.passwordData.confirmPassword=e),type:"password",placeholder:"请确认新密码"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,o.Lk)("span",b,[(0,o.bF)(H,{onClick:k.closePasswordDialog},{default:(0,o.k6)((()=>l[22]||(l[22]=[(0,o.eW)("取消")]))),_:1},8,["onClick"]),(0,o.bF)(H,{type:"primary",onClick:k.updatePassword},{default:(0,o.k6)((()=>l[23]||(l[23]=[(0,o.eW)("确定")]))),_:1},8,["onClick"])])])),_:1},8,["modelValue","before-close"]),(0,o.bF)(A,{modelValue:k.isLogoutDialogVisible,"onUpdate:modelValue":l[11]||(l[11]=e=>k.isLogoutDialogVisible=e),title:"",width:"400px","before-close":k.closeLogoutDialog},{default:(0,o.k6)((()=>[(0,o.bF)(y,{class:"out"},{default:(0,o.k6)((()=>l[24]||(l[24]=[(0,o.Lk)("span",null,"是否确定退出",-1)]))),_:1}),(0,o.Lk)("span",f,[(0,o.bF)(H,{type:"primary",onClick:k.confirmLogout},{default:(0,o.k6)((()=>l[25]||(l[25]=[(0,o.eW)("确定")]))),_:1},8,["onClick"]),(0,o.bF)(H,{onClick:k.closeLogoutDialog},{default:(0,o.k6)((()=>l[26]||(l[26]=[(0,o.eW)("取消")]))),_:1},8,["onClick"])])])),_:1},8,["modelValue","before-close"])])}a(4114);var p=a(144),g=a(1387),m=a(8352),w=a(7477),F=a(1219),_={components:{Header:m.A,Avatar:w.Avatar,Setting:w.Setting,Lock:w.Lock},setup(){const e=(0,g.rd)(),l=(0,p.KR)(0),a=(0,p.KR)("1"),t=(0,p.KR)(!1),s=(0,p.KR)(!1),d=(0,p.KR)(!1);let r="";const u=(0,p.Kh)({uid:localStorage.getItem("uid"),avatar:"",uname:"",selfintroduction:"",password:"",sex:"",birth:"",tel:""}),n=localStorage.getItem("uid");n?console.log("用户ID:",n):console.log("没有找到用户ID");const i=(0,p.Kh)({oldPassword:"",newPassword:"",confirmPassword:""}),c=async()=>{if(!n)return F.nk.error("用户丢失"),void console.log("缺少uid");try{const e=await fetch(`http://localhost:4050/get_user_info?uid=${n}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();200===l.code?(console.log(l.message),u.avatar=l.data.avatar,console.log(u.avatar),u.uname=l.data.uname,u.selfintroduction=l.data.selfIntroduction,u.sex=l.data.sex,u.birth=l.data.birth,u.tel=l.data.tel,u.password=l.data.password,console.log(l.data)):F.nk.error(l.message||"获取用户信息失败")}catch(e){console.error("请求失败：",e),F.nk.error("获取用户信息失败!")}};(0,o.sV)((()=>{c()}));const b=()=>{d.value=!0,console.log(d)},f=()=>{d.value=!1},k=async()=>{if(i.newPassword!==i.confirmPassword||i.oldPassword!==u.password)return console.log(i,u.password),F.nk.error("密码错误或者两次密码不一致"),void console.log("error");try{const e=await fetch("http://localhost:4050/update_user_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uid:u.uid,newPassword:i.newPassword})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();console.log(l),200===l.code?(s.value=!1,D()):F.nk.error(l.message||"修改失败")}catch(e){console.error("请求失败：",e),F.nk.error("修改失败!")}},m=()=>{s.value=!0,console.log(s.value)},w=()=>{s.value=!1},_=async()=>{u.avatar=r,console.log(u);try{const e=await fetch("http://localhost:4050/update_user_info",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();200===l.code?(F.nk.success("修改成功!"),s.value=!1,c()):F.nk.error(l.message||"修改失败")}catch(e){console.error("请求失败：",e),F.nk.error("修改失败!")}},h=()=>{t.value=!0},v=()=>{t.value=!1},V=()=>{localStorage.removeItem("uid"),(0,F.nk)("退出登录成功"),console.log("用户已退出"),v(),e.push({name:"Home"})},D=()=>{(0,F.nk)("修改密码成功"),console.log("密码已修改"),v(),V()};return{value1:l,activeMenu:a,user:u,uid:n,passwordData:i,isLogoutDialogVisible:t,isEditDialogVisible:s,isPasswordDialogVisible:d,updatePassword:k,getUserData:c,openLogoutDialog:h,closeLogoutDialog:v,confirmLogout:V,openEditDialog:m,closeEditDialog:w,saveUserData:_,closePasswordDialog:f,savePassword:D,openPasswordDialog:b}}},h=a(1241);const v=(0,h.A)(_,[["render",k],["__scopeId","data-v-e4d7437a"]]);var V=v}}]);
//# sourceMappingURL=91.e476f432.js.map