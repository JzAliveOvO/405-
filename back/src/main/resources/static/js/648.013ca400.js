"use strict";(self["webpackChunk_405quan"]=self["webpackChunk_405quan"]||[]).push([[648],{2648:function(e,l,a){a.r(l),a.d(l,{default:function(){return D}});var o=a(6768),t=a(4232);const s={class:"common-layout"},n={class:"main"},r={class:"profile-card-wrapper"},i={class:"profile-header"},u=["src"],c={class:"profile-info"},d={class:"profile-name"},p={class:"profile-signature"},k={class:"profile-stats"},g={class:"profile-stat"},m={class:"profile-stat"},v={class:"profile-stat"},f={class:"post-form-wrapper"},h=["src"],b={class:"el-upload-list__item-actions"},_=["onClick"],w=["onClick"],L=["onClick"],C=["src"],y={class:"card-wrapper"};function F(e,l,a,F,P,V){const R=(0,o.g2)("Header"),I=(0,o.g2)("el-header"),K=(0,o.g2)("el-card"),E=(0,o.g2)("el-input"),T=(0,o.g2)("Plus"),x=(0,o.g2)("el-icon"),D=(0,o.g2)("zoom-in"),A=(0,o.g2)("Download"),U=(0,o.g2)("Delete"),X=(0,o.g2)("el-upload"),$=(0,o.g2)("el-dialog"),j=(0,o.g2)("el-button"),H=(0,o.g2)("PostCard"),S=(0,o.g2)("el-main"),q=(0,o.g2)("el-container");return(0,o.uX)(),(0,o.CE)("div",s,[(0,o.bF)(q,null,{default:(0,o.k6)((()=>[(0,o.bF)(I,{class:"header"},{default:(0,o.k6)((()=>[(0,o.bF)(R)])),_:1}),(0,o.bF)(S,{style:{padding:"0px"}},{default:(0,o.k6)((()=>[(0,o.Lk)("div",n,[(0,o.Lk)("div",r,[(0,o.bF)(K,{class:"profile-card",style:{width:"250px"}},{default:(0,o.k6)((()=>[(0,o.Lk)("div",i,[(0,o.Lk)("img",{src:F.user.avatar,alt:"Avatar",class:"profile-avatar"},null,8,u),(0,o.Lk)("div",c,[(0,o.Lk)("span",d,(0,t.v_)(F.user.name),1),(0,o.Lk)("span",p,(0,t.v_)(F.user.signature),1)])]),(0,o.Lk)("div",k,[(0,o.Lk)("div",g,[l[2]||(l[2]=(0,o.Lk)("span",{class:"stat-label"},"总说说数:",-1)),(0,o.Lk)("span",null,(0,t.v_)(F.user.totalPosts),1)]),(0,o.Lk)("div",m,[l[3]||(l[3]=(0,o.Lk)("span",{class:"stat-label"},"总访客量:",-1)),(0,o.Lk)("span",null,(0,t.v_)(F.user.totalVisitors),1)]),(0,o.Lk)("div",v,[l[4]||(l[4]=(0,o.Lk)("span",{class:"stat-label"},"总点赞量:",-1)),(0,o.Lk)("span",null,(0,t.v_)(F.user.totalLikes),1)])])])),_:1})]),(0,o.Lk)("div",f,[(0,o.bF)(K,{class:"post-form-card",style:{width:"850px","margin-bottom":"10px"}},{default:(0,o.k6)((()=>[(0,o.bF)(E,{type:"textarea",modelValue:F.newPostContent,"onUpdate:modelValue":l[0]||(l[0]=e=>F.newPostContent=e),placeholder:"有什么新鲜事想分享吗？",rows:"3"},null,8,["modelValue"]),(0,o.bF)(X,{action:"","list-type":"picture-card","auto-upload":!1,"on-change":F.handleSuccess},{file:(0,o.k6)((({file:e})=>[(0,o.Lk)("div",null,[(0,o.Lk)("img",{class:"el-upload-list__item-thumbnail",src:e.url,alt:""},null,8,h),(0,o.Lk)("span",b,[(0,o.Lk)("span",{class:"el-upload-list__item-preview",onClick:l=>F.handlePictureCardPreview(e)},[(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.bF)(D)])),_:1})],8,_),F.disabled?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",{key:0,class:"el-upload-list__item-delete",onClick:l=>F.handleDownload(e)},[(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.bF)(A)])),_:1})],8,w)),F.disabled?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",{key:1,class:"el-upload-list__item-delete",onClick:l=>F.handleRemove(e)},[(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.bF)(U)])),_:1})],8,L))])])])),default:(0,o.k6)((()=>[(0,o.bF)(x,null,{default:(0,o.k6)((()=>[(0,o.bF)(T)])),_:1})])),_:1},8,["on-change"]),(0,o.bF)($,{modelValue:F.dialogVisible,"onUpdate:modelValue":l[1]||(l[1]=e=>F.dialogVisible=e)},{default:(0,o.k6)((()=>[(0,o.Lk)("img",{"w-full":"",src:F.dialogImageUrl,alt:"Preview Image"},null,8,C)])),_:1},8,["modelValue"]),(0,o.bF)(j,{type:"primary",onClick:F.publishPost,style:{"margin-top":"10px"}},{default:(0,o.k6)((()=>l[5]||(l[5]=[(0,o.eW)(" 发表说说 ")]))),_:1},8,["onClick"])])),_:1})]),(0,o.Lk)("div",y,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(F.posts,(e=>((0,o.uX)(),(0,o.Wv)(K,{key:e.id,class:"post-card",style:{width:"850px","margin-bottom":"10px"}},{default:(0,o.k6)((()=>[(0,o.bF)(H,{post:e,onComment:F.handleComment,onLike:F.handleLike},null,8,["post","onComment","onLike"])])),_:2},1024)))),128))])])])),_:1})])),_:1})])}a(8992),a(4520),a(2577),a(3949),a(8872);var P=a(8352),V=a(1475),R=a(4373),I=a(144),K=a(1219),E={components:{Header:P.A,PostCard:V.A},setup(){const e=(0,I.KR)(""),l=(0,I.KR)(!1),a=(0,I.KR)(!1),t=(0,I.KR)([]),s=(0,I.KR)(""),n=(0,I.KR)(null),r=localStorage.getItem("uid"),i=(0,I.KR)(""),u=((0,I.KR)(null),e=>{console.log(e)}),c=a=>{e.value=a.url,l.value=!0,console.log(e.value,a.url)},d=l=>{console.log(l),console.log(l.raw),e.value=l.raw,console.log(e.value)},p=l=>{e.value=l.raw,console.log(l.raw),console.log(e.value)};r?console.log("用户ID:",r):console.log("没有找到用户ID");const k=async()=>{try{const e=await fetch("http://localhost:4050/get_all_posts",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();if(200===l.code){console.log(l);const e=l.data.filter((e=>e.user.name===i.value));t.value=e,f.value.totalPosts=t.value.length,f.value.totalLikes=e.reduce(((e,l)=>e+l.likes),0)}else K.nk.error(l.message||"获取个人说说信息失败")}catch(e){console.error("请求失败：",e),K.nk.error("获取个人说说信息失败!")}},g=async()=>{if(!r)return K.nk.error("用户丢失"),void console.log("缺少uid");try{const e=await fetch(`http://localhost:4050/get_user_info?uid=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();200===l.code?(console.log(l.message),i.value=l.data.uname):K.nk.error(l.message||"获取用户信息失败")}catch(e){console.error("请求失败：",e),K.nk.error("获取用户信息失败!")}};(0,o.sV)((()=>{g(),k()}));const m=(e,l)=>{console.log(`评论说说 ${e}: ${l.content}`)},v=e=>{const l=t.value.find((l=>l.id===e));l&&(l.likes+=1)},f=(0,I.KR)({avatar:"",name:"",signature:"",totalPosts:"",totalVisitors:"",totalLikes:""}),h=async()=>{if(!s.value)return void K.nk.error("内容不能为空！");const l=new FormData;l.append("content",s.value),l.append("uid",localStorage.getItem("uid")),l.append("image",e.value),console.log(e.value),l.forEach(((e,l)=>{console.log(l,e)}));try{const e=await R.A.post("http://localhost:4050/add_post",l,{headers:{"Content-Type":"multipart/form-data"}});200===e.data.code?(K.nk.success("发表成功！"),s.value="",n.value=null):K.nk.error("发布失败！")}catch(a){K.nk.error("发布失败！")}};return{posts:t,handleComment:m,handleLike:v,user:f,uid:r,getUserData:g,uname:i,newPostContent:s,uploadedImage:n,publishPost:h,dialogImageUrl:e,dialogVisible:l,disabled:a,handleRemove:u,handlePictureCardPreview:c,handleDownload:d,handleSuccess:p}}},T=a(1241);const x=(0,T.A)(E,[["render",F],["__scopeId","data-v-5b319889"]]);var D=x}}]);
//# sourceMappingURL=648.013ca400.js.map